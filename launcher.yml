name: gpt-neox-zero1-3d-parallel
debug: false
hyperparameters:
  use_wandb: true
  wandb_team: rtalari-coreweave
environment:
    environment_variables:
        - NCCL_DEBUG=INFO
        # You may need to modify this to match your network configuration.
        - NCCL_SOCKET_IFNAME=ens,eth,ib
    force_pull_image: true
    image:
      gpu: liamdetermined/gpt-neox
      # gpu: rtalaricw/gpt_neox:v0.5
resources:
  slots_per_trial: 8
searcher:
  name: single
  metric: lm_loss
  smaller_is_better: false
  max_length:
    batches: 10000
min_validation_period:
    batches: 5000
max_restarts: 0
entrypoint:
  # - python3
  # - -m
  # - determined.launch.deepspeed
  - python3.8
  - /gpt-ds/deepy.py 
  - /gpt-ds/train.py
  - /gpt-ds/small.yml


