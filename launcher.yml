name: gpt-neox-zero1-3d-parallel
debug: false
hyperparameters:
  use_wandb: true
  wandb_team: rtalari-coreweave
environment:
    environment_variables:
        - NCCL_DEBUG=INFO
        # You may need to modify this to match your network configuration.
        - NCCL_SOCKET_IFNAME=ens,eth,ib
    force_pull_image: true
    image:
      # UNCOMMENT if using determined.ai
      # gpu: liamdetermined/gpt-neox
      gpu: rtalaricw/torch1.12.1_cuda11.6:det-0.19.2-v0.0
resources:
  slots_per_trial: 8
searcher:
  name: single
  metric: lm_loss
  smaller_is_better: false
  max_length:
    batches: 10000
min_validation_period:
    batches: 5000
max_restarts: 0
entrypoint:
  # UNCOMMENT if using determined.ai to use their launcher
  # - python3
  # - -m
  # - determined.launch.deepspeed
  - /usr/bin/python3.8
  - /gpt-ds/deepy.py 
  - /gpt-ds/train.py
  - /gpt-ds/small.yml


